= üèó System Architecture & Module Interaction
:toc: left
:icons: font

Transpiler-Pro is built on a *Decoupled Logic Architecture*. The Python source code remains "pure"‚Äîit contains the algorithms for transformation but contains no hardcoded strings, branding or specific grammar rules. Instead, it consumes data from the *SUSE Style Guide* and a *Persistent Knowledge Base*.

== üõ∞ Orchestration Layer

* `cli.py`:: The central conductor. It manages the lifecycle of a transpilation job using *Typer*. It handles recursive file discovery, ensures the output directory mirrors the input structure, and executes the final *Antora Refinement* (header injection and path normalization).

== ‚öôÔ∏è Core Transformation & Repair Layer

=== 1. `core/converter.py` (The Structural Engineer)

Handles the "Shield-Transpile-Restore" workflow:

* *Shielding* - Protects complex Markdown elements (Admonitions, Collapsibles, XREFs) using regex-defined markers from `pyproject.toml`.
* *Structural Conversion* - Executes `kramdoc` for standard Markdown-to-AsciiDoc conversion.
* *Restoration* - Replaces markers with high-fidelity, Antora-compliant AsciiDoc blocks.

=== 2. `core/linter.py` (The Style Sensor)

Integrates the *Vale CLI* as a diagnostic engine. It maps the official SUSE style library against the generated AsciiDoc. It does not just find errors; it extracts *Correction Metadata* (suggestions, rule IDs, and triggers) to fuel the Fixer.

=== 3. `core/fixer.py` (The NLP Healer & Learner)
The most sophisticated layer, utilizing *spaCy NLP* and a *Dynamic Knowledge Base*:

* *Grammar Repair* - Uses Dependency Parsing to fix tenses. It identifies the "Head" verb and its "Subjects" to choose correct progressive forms (for example, "The nodes are" vs. "The node is").
* *Learning Engine* - If a spelling error is found that is not in the knowledge base, it logs the discovery to `data/knowledge_base.json`.
* *Global Enforcement* - A safety-net pass that ensures branding (SUSE, Wi-Fi) is corrected even if the linter fails to flag it.

== üîÑ The Smart-Pipeline Data Flow

. *Ingestion* -  Markdown is pulled from `data/inputs/`.
. *Conversion (Phase 1)* - Structural transformation occurs; complex blocks are converted to Antora-standard syntax.
. *Validation (Phase 2)* - The Linter generates a "Violation Map" of style and branding errors.
. *Auto-Heal (Phase 2.5)* - The Fixer performs three sub-passes:
** *Contextual Grammar*: Tense correction via NLP.
** *Surgical Removal*: Deletion of editorial "fluff" (very, simple, note that).
** *Branding Pass*: Force-caps and casing from the Knowledge Base.
. *Final Refinement (Phase 3)* - Antora headers (`:experimental:`, `:toc:`, etc.) are injected, and the Knowledge Base is saved.

== üìÅ Data Driven Layout

[cols="1,2,2", options="header"]
|===
| Component | Responsibility | Source of Truth
| *Fixer Logic* | How to fix a sentence. | `fixer.py`
| *Branding Data* | Which words to fix. | `data/knowledge_base.json`
| *Grammar Rules* | Irregular verb conjugations. | `pyproject.toml`
| *Style Rules* | SUSE technical standards. | `styles/suse-styles/`
|===